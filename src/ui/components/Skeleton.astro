---
export interface Props {
  height?: string;
  width?: string;
  rounded?: 'sm' | 'md' | 'lg' | 'xl' | 'full';
  variant?: 'rectangular' | 'circular' | 'text';
  lines?: number;
  className?: string;
}

const { 
  height = 'h-4',
  width = 'w-full',
  rounded = 'md',
  variant = 'rectangular',
  lines = 1,
  className = ''
} = Astro.props;

const roundedClasses = {
  sm: 'rounded-sm',
  md: 'rounded-md',
  lg: 'rounded-lg',
  xl: 'rounded-xl',
  full: 'rounded-full'
};

const baseClasses = 'animate-pulse bg-gradient-to-r from-gray-600 via-gray-500 to-gray-600 bg-[length:200%_100%]';

function getSkeletonClasses(index: number = 0) {
  let classes = `${baseClasses} ${height} ${width} ${roundedClasses[rounded]} ${className}`;
  
  if (variant === 'circular') {
    classes = `${baseClasses} ${height} ${height} rounded-full ${className}`;
  } else if (variant === 'text') {
    // Para líneas de texto, variar el ancho para que se vea más natural
    const widths = ['w-full', 'w-5/6', 'w-4/5', 'w-3/4', 'w-2/3'];
    const selectedWidth = index < widths.length ? widths[index] : 'w-full';
    classes = `${baseClasses} h-4 ${selectedWidth} rounded ${className}`;
  }
  
  return classes;
}
---

<div class="skeleton-container">
  {variant === 'text' && lines > 1 ? (
    <div class="space-y-2">
      {Array.from({ length: lines }).map((_, index) => (
        <div class={getSkeletonClasses(index)}></div>
      ))}
    </div>
  ) : (
    <div class={getSkeletonClasses()}></div>
  )}
</div>

<style>
  .skeleton-container .animate-pulse {
    animation: shimmer 2s ease-in-out infinite;
  }
  
  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }
  
  /* Mejora la animación del skeleton */
  .skeleton-container [class*="bg-gradient-to-r"] {
    background: linear-gradient(
      90deg,
      #4b5563 25%,
      #6b7280 50%,
      #4b5563 75%
    );
    background-size: 200% 100%;
  }
</style>
