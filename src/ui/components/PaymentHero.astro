---
// Componente Hero para la p谩gina de pagos con botones de acci贸n
import { getCurrentLocale, getTranslation } from '../../i18n';

const currentLocale = getCurrentLocale(Astro);
const t = (key: string) => getTranslation(currentLocale, key);
---

<div class="text-center mb-12">
  <div
    class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-anakiwa-400 to-anakiwa-600 rounded-full mb-6 shadow-2xl"
  >
    <svg class="w-10 h-10 text-[var(--primary-contrast)]" fill="currentColor" viewBox="0 0 20 20">
      <path
        d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z"
      ></path>
    </svg>
  </div>
  <h1 class="text-4xl md:text-5xl font-bold text-[var(--fg)] mb-4">
    <span class="bg-gradient-to-r from-anakiwa-300 to-anakiwa-500 bg-clip-text text-transparent">
      {t('payments.pageTitle')}
    </span>
  </h1>
  <p class="text-[var(--mutedFg)] text-lg max-w-2xl mx-auto leading-relaxed mb-8">
    {t('payments.heroDescription')}
    <span class="text-anakiwa-400 font-semibold">Hive Keychain</span>
  </p>

  <!-- Informaci贸n de resumen y botones de acci贸n -->
  <div
    id="payment-summary"
    class="hidden bg-[var(--bgElevated)] backdrop-blur-sm border border-[var(--border)] rounded-xl p-6 mb-8 max-w-4xl mx-auto"
  >
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
      <!-- Total de pagos -->
      <div class="text-center">
        <div class="text-2xl font-bold text-[var(--fg)]" id="total-payments">0</div>
        <div class="text-sm text-[var(--mutedFg)]">{t('payments.totalPayments')}</div>
      </div>
      <!-- Monto total -->
      <div class="text-center">
        <div class="text-2xl font-bold text-anakiwa-400" id="total-amount">0.000 HIVE</div>
        <div class="text-sm text-[var(--mutedFg)]">{t('payments.totalAmount')}</div>
      </div>
      <!-- Usuario conectado -->
      <div class="text-center">
        <div class="text-lg font-semibold text-anakiwa-400" id="connected-user">{t('payments.notConnected')}</div>
        <div class="text-sm text-[var(--mutedFg)]">{t('payments.activeUser')}</div>
      </div>
    </div>

    <!-- Botones de acci贸n -->
    <div class="flex flex-col gap-6 justify-center">
      <!-- Primera fila: Botones principales -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <!-- Bot贸n de pago completo -->
        <button
          id="execute-all-payments"
          class="relative w-full sm:w-auto flex items-center justify-center gap-3 bg-gradient-to-r from-anakiwa-500 to-anakiwa-600 hover:from-anakiwa-600 hover:to-anakiwa-700 text-[var(--primary-contrast)] font-bold px-6 sm:px-8 py-3 sm:py-4 rounded-xl transition-transform duration-150 active:scale-95 shadow-lg disabled:opacity-50 disabled:pointer-events-none"
          disabled
        >
          <svg class="w-5 h-5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span class="truncate">{t('payments.executeAll')}</span>
          <!-- Overlay de carga -->
          <div
            id="all-payments-loading"
            class="absolute inset-0 bg-black/40 rounded-xl flex items-center justify-center hidden"
          >
            <svg class="animate-spin w-5 h-5 text-white" fill="none" viewBox="0 0 24 24">
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
            </svg>
          </div>
        </button>

        <!--  Bot贸n para pagos por lotes -->
        <button
          id="execute-batch-payments"
          class="flex items-center justify-center gap-3 bg-gradient-to-r from-anakiwa-600 to-anakiwa-700 hover:from-anakiwa-700 hover:to-anakiwa-800 text-[var(--primary-contrast)] font-bold px-8 py-4 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
          disabled
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path
              d="M4 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H4zM4 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H4zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM13 13a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2h-2z"
            ></path>
          </svg>
          <span>{t('payments.batchSize').replace('{size}', '20')}</span>
        </button>
      </div>

      <!-- Segunda fila: Botones de gesti贸n de lotes -->
      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <!--  Bot贸n continuar lotes -->
        <button
          id="continue-batch-payments"
          class="flex items-center justify-center gap-2 bg-gradient-to-r from-anakiwa-500 to-anakiwa-600 hover:from-anakiwa-600 hover:to-anakiwa-700 text-[var(--primary-contrast)] font-medium px-6 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
          disabled
        >
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M10.293 15.707a1 1 0 010-1.414L14.586 10l-4.293-4.293a1 1 0 111.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z"
              clip-rule="evenodd"></path>
            <path
              fill-rule="evenodd"
              d="M4.293 15.707a1 1 0 010-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z"
              clip-rule="evenodd"></path>
          </svg>
          <span>{t('payments.continueBatch')}</span>
        </button>

        <!--  Bot贸n resetear lotes -->
        <button
          id="reset-batch-payments"
          class="flex items-center justify-center gap-2 bg-[var(--bgElevated)] border border-[var(--border)] hover:bg-[var(--bg)] text-[var(--mutedFg)] hover:text-[var(--fg)] font-medium px-6 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
        >
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
              clip-rule="evenodd"></path>
          </svg>
          <span>{t('payments.resetBatch')}</span>
        </button>
      </div>
    </div>

    <!-- Tercera fila: Botones adicionales -->
    <div class="flex flex-col sm:flex-row gap-3 justify-center mt-8">
      <!-- Bot贸n de refrescar datos -->
      <button
        id="refresh-data"
        class="flex items-center justify-center gap-3 bg-gradient-to-r from-anakiwa-500 to-anakiwa-600 hover:from-anakiwa-600 hover:to-anakiwa-700 text-[var(--primary-contrast)] font-medium px-6 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
      >
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path
            fill-rule="evenodd"
            d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
            clip-rule="evenodd"></path>
        </svg>
        <span>{t('payments.refresh')}</span>
      </button>
    </div>
  </div>

  <!--  Contenedor para progreso de lotes -->
  <div id="batch-progress" class="max-w-2xl mx-auto mt-6"></div>
</div>

<!-- Botones de pagos por grupos (solo visible en vista de grupos) -->
<div id="group-payment-buttons" class="hidden">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-4xl mx-auto mb-8">
    <!-- Grupo Alto Valor -->
    <div
      class="bg-anakiwa-900/10 backdrop-blur-sm border border-anakiwa-500/30 rounded-xl p-6"
    >
      <div class="text-center mb-4">
        <div class="text-2xl font-bold text-anakiwa-400" id="high-group-count">0</div>
        <div class="text-sm text-anakiwa-300">{t('payments.highValuePayments')}</div>
        <div class="text-lg font-semibold text-anakiwa-200" id="high-group-amount">0.000 HIVE</div>
      </div>
      <button
        id="execute-high-payments"
        class="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-anakiwa-600 to-anakiwa-700 hover:from-anakiwa-700 hover:to-anakiwa-800 text-[var(--primary-contrast)] font-bold px-4 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
        disabled
      >
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span>{t('payments.executeHighValue')}</span>
      </button>
    </div>

    <!-- Grupo Valor Medio -->
    <div
      class="bg-anakiwa-900/10 backdrop-blur-sm border border-anakiwa-500/30 rounded-xl p-6"
    >
      <div class="text-center mb-4">
        <div class="text-2xl font-bold text-anakiwa-400" id="medium-group-count">0</div>
        <div class="text-sm text-anakiwa-300">{t('payments.mediumValuePayments')}</div>
        <div class="text-lg font-semibold text-anakiwa-200" id="medium-group-amount">0.000 HIVE</div>
      </div>
      <button
        id="execute-medium-payments"
        class="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-anakiwa-500 to-anakiwa-600 hover:from-anakiwa-600 hover:to-anakiwa-700 text-[var(--primary-contrast)] font-bold px-4 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
        disabled
      >
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span>{t('payments.executeMediumValue')}</span>
      </button>
    </div>

    <!-- Grupo Bajo Valor -->
    <div
      class="bg-anakiwa-900/10 backdrop-blur-sm border border-anakiwa-500/30 rounded-xl p-6"
    >
      <div class="text-center mb-4">
        <div class="text-2xl font-bold text-anakiwa-400" id="low-group-count">0</div>
        <div class="text-sm text-anakiwa-300">{t('payments.lowValuePayments')}</div>
        <div class="text-lg font-semibold text-anakiwa-200" id="low-group-amount">0.000 HIVE</div>
      </div>
      <button
        id="execute-low-payments"
        class="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-anakiwa-400 to-anakiwa-500 hover:from-anakiwa-500 hover:to-anakiwa-600 text-[var(--primary-contrast)] font-bold px-4 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
        disabled
      >
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span>{t('payments.executeLowValue')}</span>
      </button>
    </div>
  </div>
</div>
