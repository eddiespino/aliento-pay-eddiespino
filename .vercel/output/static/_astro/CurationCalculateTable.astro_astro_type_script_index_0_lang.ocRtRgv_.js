import{_ as b}from"./preload-helper.BlTxHScW.js";window.addEventListener("percentageChange",r=>{const c=r,{percentage:s,newAmount:n}=c.detail,e=document.getElementById("total-hive-display");e&&(e.textContent=`Total Hive: ${n.toFixed(3)}`),document.querySelectorAll('[data-row-type="delegator"]').forEach((l,i)=>{const o=l.getAttribute("data-base-hive"),a=l.getAttribute("data-percentage");if(!o||!a)return;const u=parseFloat(o),g=document.getElementById("curation-table-container"),v=parseFloat(g?.getAttribute("data-total-hive-to-distribute")||"0"),m=n/v,C=u*m,d=document.getElementById(`hive-amount-${i}`);d&&(d.textContent=`${C.toFixed(3)} HIVE`,d.classList.add("animate-pulse"),setTimeout(()=>{d.classList.remove("animate-pulse")},500))})});async function h(){try{console.log("ðŸ–¼ï¸ CurationCalculateTable: Iniciando carga de avatares...");const{getAvatarCache:r}=await b(async()=>{const{getAvatarCache:e}=await import("./avatar-cache.GCLNzyIK.js");return{getAvatarCache:e}},[]),c=r(),s=document.querySelectorAll("tr[data-delegator]");if(s.length===0){console.log("â„¹ï¸ CurationCalculateTable: No se encontraron filas de delegadores");return}const n=Array.from(s).map(e=>e.getAttribute("data-delegator")).filter(Boolean);console.log(`âš¡ CurationCalculateTable: Precargando ${n.length} avatares...`),await c.preloadAvatars(n),s.forEach(async e=>{const t=e.getAttribute("data-delegator");if(!t)return;const l=e.querySelector(".avatar-img"),i=e.querySelector(".avatar-fallback");if(!(!l||!i))try{const o=c.getAvatarUrl(t),a=document.createElement("img");a.src=o,a.alt=`@${t}`,a.className="w-8 h-8 rounded-full object-cover",a.onload=function(){l.appendChild(a),i.style.display="none",console.log(`âœ… CurationCalculateTable: Avatar cargado para @${t}`)},a.onerror=function(){console.log(`âš ï¸ CurationCalculateTable: Avatar fallido para @${t}, usando fallback`)}}catch(o){console.warn(`âš ï¸ CurationCalculateTable: Error procesando avatar para @${t}:`,o)}}),console.log("âœ… CurationCalculateTable: Proceso de carga de avatares completado")}catch(r){console.error("âŒ CurationCalculateTable: Error en loadAvatarsWithCache:",r)}}window.addEventListener("DOMContentLoaded",()=>{setTimeout(h,100)});
