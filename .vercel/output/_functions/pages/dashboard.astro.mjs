/* empty css                                     */
import { c as createComponent, a as createAstro, m as maybeRenderHead, e as renderScript, d as renderTemplate, b as addAttribute, s as spreadAttributes, r as renderSlot, j as defineScriptVars, f as renderComponent } from '../chunks/astro/server_DTs-x8oe.mjs';
import 'kleur/colors';
import { $ as $$Layout } from '../chunks/Layout_8Z7cByMN.mjs';
import 'clsx';
/* empty css                                     */
import { $ as $$Header } from '../chunks/header_BBSmWFYD.mjs';
import { r as requireAuthentication } from '../chunks/middleware_BdI7ZZ7X.mjs';
import { p as protectedGetCurationStats } from '../chunks/protected-functions_CRY-T2Fm.mjs';
import { $ as $$BrandCard } from '../chunks/BrandCard_IAK74zIN.mjs';
export { renderers } from '../renderers.mjs';

const $$Astro$3 = createAstro();
const $$Filters = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro$3, $$props, $$slots);
  Astro2.self = $$Filters;
  return renderTemplate`<!-- Delegation Filters -->${maybeRenderHead()}<div id="filters-container" class="bg-[#18181b] rounded-2xl border border-[#232329] p-6 mb-6" data-astro-cid-rqzvh5c2> <div class="flex items-center gap-2 mb-6" data-astro-cid-rqzvh5c2> <svg class="w-5 h-5 text-sky-600" fill="currentColor" viewBox="0 0 20 20" data-astro-cid-rqzvh5c2> <path fill-rule="evenodd" d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z" clip-rule="evenodd" data-astro-cid-rqzvh5c2></path> </svg> <h2 class="text-xl font-bold text-white" data-astro-cid-rqzvh5c2>Delegation Filters</h2> </div> <div class="grid grid-cols-1 lg:grid-cols-4 gap-6" data-astro-cid-rqzvh5c2> <!-- Curation Period Selection --> <div data-astro-cid-rqzvh5c2> <h3 class="text-sm font-semibold text-gray-300 mb-3" data-astro-cid-rqzvh5c2> <div class="flex items-center gap-2" data-astro-cid-rqzvh5c2> <svg class="w-4 h-4 text-amber-500" fill="currentColor" viewBox="0 0 20 20" data-astro-cid-rqzvh5c2> <path fill-rule="evenodd" d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd" data-astro-cid-rqzvh5c2></path> </svg>
Curation Period
</div> </h3> <div class="space-y-2" data-filter-group="curation-period" data-astro-cid-rqzvh5c2> <button id="curation-btn-24h" class="curation-period-btn w-full rounded-lg p-3 text-left transition-all duration-200" data-filter-type="curation-period" data-filter-value="24h" data-filter-state="inactive" data-period="24h" data-value="0" data-astro-cid-rqzvh5c2> <div class="flex items-center justify-between mb-1" data-astro-cid-rqzvh5c2> <span class="text-sm font-medium text-blue-300" data-astro-cid-rqzvh5c2>24 Hours</span> <div class="w-3 h-3 rounded-full border-2 border-gray-500 curation-radio" data-astro-cid-rqzvh5c2></div> </div> <div class="text-lg font-bold text-white mb-1 curation-value" data-astro-cid-rqzvh5c2>0.0000 HP</div> </button> <button id="curation-btn-7d" class="curation-period-btn w-full rounded-lg p-3 text-left transition-all duration-200" data-filter-type="curation-period" data-filter-value="7d" data-filter-state="inactive" data-period="7d" data-value="0" data-astro-cid-rqzvh5c2> <div class="flex items-center justify-between mb-1" data-astro-cid-rqzvh5c2> <span class="text-sm font-medium text-emerald-300" data-astro-cid-rqzvh5c2>7 Days</span> <div class="w-3 h-3 rounded-full border-2 border-gray-500 curation-radio" data-astro-cid-rqzvh5c2></div> </div> <div class="text-lg font-bold text-white mb-1 curation-value" data-astro-cid-rqzvh5c2>0.0000 HP</div> </button> <button id="curation-btn-30d" class="curation-period-btn w-full rounded-lg p-3 text-left transition-all duration-200" data-filter-type="curation-period" data-filter-value="30d" data-filter-state="inactive" data-period="30d" data-value="0" data-astro-cid-rqzvh5c2> <div class="flex items-center justify-between mb-1" data-astro-cid-rqzvh5c2> <span class="text-sm font-medium text-white" data-astro-cid-rqzvh5c2>30 Days</span> <div class="w-3 h-3 rounded-full border-2 border-gray-500 curation-radio" data-astro-cid-rqzvh5c2></div> </div> <div class="text-lg font-bold text-white mb-1 curation-value" data-astro-cid-rqzvh5c2>0.0000 HP</div> </button> </div> <div class="mt-3 p-2 bg-[#0f172a] border border-amber-800/30 rounded-lg" data-astro-cid-rqzvh5c2> <div class="text-xs text-amber-200" data-astro-cid-rqzvh5c2> <div class="font-medium mb-1" data-astro-cid-rqzvh5c2>Payment calculation:</div> <div class="text-amber-300/80" data-astro-cid-rqzvh5c2>Period used for dynamic payment percentages.</div> </div> </div> </div> <!-- Time Period --> <div data-astro-cid-rqzvh5c2> <h3 class="text-sm font-semibold text-gray-300 mb-3" data-astro-cid-rqzvh5c2>Time Period (Days)</h3> <div class="grid grid-cols-3 gap-2" data-filter-group="time-period" data-astro-cid-rqzvh5c2> <button id="time-period-btn-1" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="time-period" data-filter-value="1" data-filter-state="inactive" data-value="1" data-astro-cid-rqzvh5c2>
1 day
</button> <button id="time-period-btn-3" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="time-period" data-filter-value="3" data-filter-state="inactive" data-value="3" data-astro-cid-rqzvh5c2>
3 days
</button> <button id="time-period-btn-7" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="time-period" data-filter-value="7" data-filter-state="inactive" data-value="7" data-astro-cid-rqzvh5c2>
7 days
</button> <button id="time-period-btn-14" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="time-period" data-filter-value="14" data-filter-state="inactive" data-value="14" data-astro-cid-rqzvh5c2>
14 days
</button> <button id="time-period-btn-21" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="time-period" data-filter-value="21" data-filter-state="inactive" data-value="21" data-astro-cid-rqzvh5c2>
21 days
</button> <button id="time-period-btn-30" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="time-period" data-filter-value="30" data-filter-state="active" data-value="30" data-astro-cid-rqzvh5c2>
30 days
</button> </div> </div> ${renderScript($$result, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/components/filters.astro?astro&type=script&index=0&lang.ts")}  <!-- Minimum HP --> <div data-astro-cid-rqzvh5c2> <h3 class="text-sm font-semibold text-gray-300 mb-3" data-astro-cid-rqzvh5c2>Minimum HP</h3> <div class="grid grid-cols-2 gap-2 mb-3" data-filter-group="minimum-hp" data-astro-cid-rqzvh5c2> <button id="min-hp-btn-50" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="minimum-hp" data-filter-value="50" data-filter-state="active" data-value="50" data-astro-cid-rqzvh5c2>
50 HP
</button> <button id="min-hp-btn-100" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="minimum-hp" data-filter-value="100" data-filter-state="inactive" data-value="100" data-astro-cid-rqzvh5c2>
100 HP
</button> <button id="min-hp-btn-500" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="minimum-hp" data-filter-value="500" data-filter-state="inactive" data-value="500" data-astro-cid-rqzvh5c2>
500 HP
</button> <button id="min-hp-btn-1000" class="filter-btn py-2 px-4 rounded-lg transition-all duration-150" data-filter-type="minimum-hp" data-filter-value="1000" data-filter-state="inactive" data-value="1000" data-astro-cid-rqzvh5c2>
1000 HP
</button> </div> <div class="relative" data-astro-cid-rqzvh5c2> <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" data-astro-cid-rqzvh5c2>$</span> <input id="custom-hp-input" type="number" value="50" class="w-full bg-[#232329] border border-[#232329] text-white placeholder-gray-500 pl-8 pr-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-600 transition" data-astro-cid-rqzvh5c2> </div> </div> <!-- Excluded Accounts --> <div data-astro-cid-rqzvh5c2> <h3 class="text-sm font-semibold text-gray-300 mb-3" data-astro-cid-rqzvh5c2>Excluded Accounts</h3> <div class="relative" data-astro-cid-rqzvh5c2> <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20" data-astro-cid-rqzvh5c2> <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" data-astro-cid-rqzvh5c2></path> </svg> <input id="excluded-username-input" type="text" placeholder="Add username to exclude" class="w-full bg-[#232329] border border-[#232329] text-white placeholder-gray-500 pl-10 pr-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-600 transition" data-astro-cid-rqzvh5c2> </div> <!-- Lista de usuarios excluidos --> <div id="excluded-users-list" class="mt-3 space-y-2" data-astro-cid-rqzvh5c2></div> </div> </div> <!-- Botones de Confirmación --> <div class="mt-6 flex justify-center items-center relative" data-astro-cid-rqzvh5c2> <!-- Botón Apply/Edit Filters (centrado) --> <button id="apply-filters-btn" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 focus:ring-offset-[#18181b] shadow-lg hover:shadow-xl flex items-center gap-2" data-astro-cid-rqzvh5c2> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" data-astro-cid-rqzvh5c2> <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" data-astro-cid-rqzvh5c2></path> </svg>
Apply Filters
</button> <!-- Botón Next (a la derecha, inicialmente oculto) --> <button id="next-btn" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-[#18181b] shadow-lg hover:shadow-xl absolute right-0 hidden" style="display: none;" data-astro-cid-rqzvh5c2> <div class="flex items-center gap-2" data-astro-cid-rqzvh5c2> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" data-astro-cid-rqzvh5c2> <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" data-astro-cid-rqzvh5c2></path> </svg>
Next
</div> </button> </div> </div>`;
}, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/components/filters.astro", void 0);

const $$Astro$2 = createAstro();
const $$TableDelegations = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro$2, $$props, $$slots);
  Astro2.self = $$TableDelegations;
  return renderTemplate`${maybeRenderHead()}<div class="bg-[#18181b] rounded-2xl border border-[#232329] shadow-xl overflow-hidden mb-8"> <div class="p-6 border-b border-[#232329]"> <div class="flex justify-between items-center"> <div> <h2 class="text-xl font-bold text-white">Current Delegations</h2> <p class="text-gray-400 text-sm mt-1">All active delegations to your account</p> <div class="flex items-center gap-2 mt-2"> <div class="bg-green-600/20 border border-green-600/50 rounded-lg px-2 py-1"> <span class="text-green-400 text-xs font-medium">⚡ Optimized</span> </div> <span class="text-gray-500 text-xs">Essential data only - instant loading</span> </div> </div> <div class="flex items-center gap-3"> <div id="delegation-stats" class="text-right text-sm"> <p class="text-gray-400">Total Delegations</p> <p id="total-delegations" class="text-white font-bold">--</p> </div> <div class="text-right text-sm"> <p class="text-gray-400">Total HP</p> <p id="total-hp-display" class="text-green-400 font-bold">-- HP</p> </div> <button id="refresh-btn" class="bg-sky-600 hover:bg-sky-700 text-white font-medium py-2 px-4 rounded-lg shadow transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 flex items-center gap-2" title="Refresh delegations"> <svg id="refresh-icon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path> </svg> <span class="hidden sm:inline">Refresh</span> </button> </div> </div> </div> <!-- Skeleton Loading State --> <div id="skeleton-state" class="hidden"> <!-- Skeleton para estadísticas --> <div class="p-6 border-b border-[#232329]"> <div class="flex justify-between items-center"> <div class="flex-1"> <div class="h-6 bg-gray-600 rounded w-48 mb-2 animate-pulse"></div> <div class="h-4 bg-gray-700 rounded w-64 animate-pulse"></div> </div> <div class="flex items-center gap-6"> <div class="text-right"> <div class="h-3 bg-gray-700 rounded w-24 mb-1 animate-pulse"></div> <div class="h-5 bg-gray-600 rounded w-12 animate-pulse"></div> </div> <div class="text-right"> <div class="h-3 bg-gray-700 rounded w-16 mb-1 animate-pulse"></div> <div class="h-5 bg-gray-600 rounded w-20 animate-pulse"></div> </div> <div class="h-10 bg-gray-600 rounded-lg w-24 animate-pulse"></div> </div> </div> </div> <!-- Skeleton para tabla --> <div class="overflow-x-auto"> <table class="w-full"> <thead> <tr class="bg-[#232329]"> <th class="text-left py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-20 animate-pulse"></div> </th> <th class="text-left py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-12 animate-pulse"></div> </th> <th class="text-left py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-16 animate-pulse"></div> </th> <th class="text-left py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-16 animate-pulse"></div> </th> <th class="text-left py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-24 animate-pulse"></div> </th> </tr> </thead> <tbody> <!-- Skeleton rows --> ${Array.from({ length: 8 }).map(() => renderTemplate`<tr class="border-b border-[#232329] last:border-b-0"> <td class="py-4 px-6"> <div class="flex items-center gap-3"> <div class="h-8 w-8 bg-gray-600 rounded-full animate-pulse"></div> <div class="h-4 bg-gray-600 rounded w-24 animate-pulse"></div> </div> </td> <td class="py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-20 animate-pulse"></div> </td> <td class="py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-16 animate-pulse"></div> </td> <td class="py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-32 animate-pulse"></div> </td> <td class="py-4 px-6"> <div class="h-4 bg-gray-600 rounded w-20 animate-pulse"></div> </td> </tr>`)} </tbody> </table> </div> <!-- Loading progress indicator --> <div class="p-4 bg-[#232329] border-t border-[#2a2a32]"> <div class="flex items-center justify-center gap-3 text-gray-400 text-sm"> <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"> <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path> </svg> <span id="loading-progress">Cargando delegaciones...</span> </div> </div> </div> <!-- Fallback Loading State (for compatibility) --> <div id="loading-state" class="p-8 text-center hidden"> <div class="flex flex-col items-center gap-4"> <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"></div> <div> <p class="text-white font-medium">Loading delegations...</p> <p id="loading-progress-fallback" class="text-gray-400 text-sm mt-1">Initializing...</p> </div> </div> </div> <!-- Error State --> <div id="error-state" class="p-8 text-center hidden"> <div class="flex flex-col items-center gap-3"> <svg class="w-12 h-12 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path> </svg> <div> <p class="text-lg font-medium text-white">Error loading delegations</p> <p id="error-message" class="text-red-400 text-sm mt-1">Something went wrong</p> <button id="retry-btn" class="mt-3 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg shadow transition-all duration-150">
Try Again
</button> </div> </div> </div> <!-- Table Container --> <div id="table-container" class="overflow-x-auto hidden"> <table class="w-full"> <thead> <tr class="bg-[#232329]"> <th class="text-left py-4 px-6 text-sm font-semibold text-gray-300"> Delegator </th> <th class="text-left py-4 px-6 text-sm font-semibold text-gray-300"> HP </th> <th class="text-left py-4 px-6 text-sm font-semibold text-gray-300"> % Share </th> </tr> </thead> <tbody id="delegations-tbody"> <!-- Delegations will be inserted here --> </tbody> </table> </div> <!-- Empty State --> <div id="empty-state" class="p-12 text-center hidden"> <div class="flex flex-col items-center gap-3"> <svg class="w-16 h-16 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path> </svg> <div> <p class="text-lg font-medium text-white">No delegations found</p> <p class="text-gray-400 text-sm">You don't have any active delegations yet</p> </div> </div> </div> </div> ${renderScript($$result, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/components/tableDelegations.astro?astro&type=script&index=0&lang.ts")}`;
}, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/components/tableDelegations.astro", void 0);

const $$CacheStatusIndicator = createComponent(($$result, $$props, $$slots) => {
  return renderTemplate`${maybeRenderHead()}<div id="cache-status-indicator" class="hidden fixed bottom-4 right-4 z-50"> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-3 text-sm"> <div class="flex items-center gap-2"> <div id="cache-status-icon" class="w-3 h-3 rounded-full bg-gray-400"></div> <span id="cache-status-text" class="text-gray-600 dark:text-gray-300">...</span> </div> <div id="cache-status-details" class="text-xs text-gray-500 dark:text-gray-400 mt-1 hidden"> <div>Curation: <span id="curation-cache-age">--</span></div> <div>Last update: <span id="last-update-age">--</span></div> </div> </div> </div> ${renderScript($$result, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/components/CacheStatusIndicator.astro?astro&type=script&index=0&lang.ts")}`;
}, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/components/CacheStatusIndicator.astro", void 0);

const $$Astro$1 = createAstro();
const $$BrandContainer = createComponent(($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro$1, $$props, $$slots);
  Astro2.self = $$BrandContainer;
  const {
    variant = "page",
    class: className = "",
    withPattern = false,
    ...props
  } = Astro2.props;
  const getContainerClass = () => {
    switch (variant) {
      case "center":
        return `container-brand ${className}`;
      case "full":
        return `w-full ${withPattern ? "bg-brand-bg relative" : ""} ${className}`;
      default:
        return `page-container ${className}`;
    }
  };
  return renderTemplate`${maybeRenderHead()}<div${addAttribute(getContainerClass(), "class")}${spreadAttributes(props)}> ${withPattern && variant === "full" && renderTemplate`<div class="absolute inset-0 opacity-5 pointer-events-none"> <div class="absolute inset-0 bg-pattern-dots"></div> </div>`} ${variant === "full" && renderTemplate`<div class="relative z-10"> ${renderSlot($$result, $$slots["default"])} </div>` || renderTemplate`${renderSlot($$result, $$slots["default"])}`} </div>`;
}, "/Users/eddiespino/aliento-pay-eddiespino/src/ui/base/BrandContainer.astro", void 0);

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$Dashboard = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Dashboard;
  requireAuthentication(Astro2);
  let curationStats = null;
  let error = null;
  const authenticatedUser = Astro2.locals.user;
  const isAuthenticated = Astro2.locals.isAuthenticated;
  if (isAuthenticated && authenticatedUser) {
    try {
      curationStats = await protectedGetCurationStats(authenticatedUser);
      console.log(`\u{1F4CA} Estad\xEDsticas de curaci\xF3n obtenidas para usuario: ${authenticatedUser}`);
    } catch (err) {
      console.error("\u274C Error cargando estad\xEDsticas de curaci\xF3n en servidor:", err);
      error = err;
    }
  } else {
    console.log("\u26A0\uFE0F Dashboard: Usuario no autenticado, se cargar\xE1 en cliente");
  }
  return renderTemplate(_a || (_a = __template(["", " <script>(function(){", "\n  // \uFFFD FUNCI\xD3N GLOBAL DE AUTENTICACI\xD3N (\xFAnica definici\xF3n)\n  function checkClientAuthentication() {\n    if (typeof window === 'undefined') return { isAuthenticated: false, user: null };\n\n    const user = localStorage.getItem('authenticated_user');\n    return {\n      isAuthenticated: !!user,\n      user: user,\n    };\n  }\n\n  // \u{1F512} Control de duplicaci\xF3n para evitar m\xFAltiples peticiones simult\xE1neas\n  let isRefreshingCurationStats = false;\n  let refreshCurationStatsPromise = null;\n\n  // \u2705 FUNCI\xD3N GLOBAL PARA OBTENER DATOS DE CURACI\xD3N\n  window.getCurationStatsData = function () {\n    console.log('\u{1F4CA} getCurationStatsData llamada');\n\n    const clientAuth = checkClientAuthentication();\n    if (!clientAuth.isAuthenticated) {\n      console.warn('\u26A0\uFE0F Usuario no autenticado, no se pueden obtener estad\xEDsticas de curaci\xF3n');\n      return {\n        curation24h: 0,\n        curation7d: 0,\n        curation30d: 0,\n        lastUpdate: new Date().toISOString(),\n        error: 'Usuario no autenticado',\n        source: 'auth_error',\n        authenticated: false,\n      };\n    }\n\n    console.log(`\u{1F512} Usuario autenticado: ${clientAuth.user}`);\n\n    // 1. Intentar obtener del cach\xE9 por usuario primero\n    try {\n      // Usar el nuevo sistema de cach\xE9 si est\xE1 disponible\n      if (typeof window.userCache !== 'undefined') {\n        const cachedData = window.userCache.get('curation_stats');\n        if (cachedData) {\n          const age = window.userCache.getAge('curation_stats') || 0;\n          console.log(\n            `\u2705 Datos de curaci\xF3n obtenidos del cach\xE9 por usuario para ${clientAuth.user} (${Math.round(age / 1000)}s antiguos)`\n          );\n          return {\n            curation24h: cachedData.curation24h || 0,\n            curation7d: cachedData.curation7d || 0,\n            curation30d: cachedData.curation30d || 0,\n            lastUpdate: cachedData.lastUpdate || new Date().toISOString(),\n            error: cachedData.error || false,\n            source: 'user_cache',\n            user: clientAuth.user,\n            authenticated: true,\n          };\n        }\n      } else {\n        // Fallback al sistema legacy\n        const cacheKey = `curation_stats_${clientAuth.user}`;\n        const cachedData = localStorage.getItem(cacheKey);\n        if (cachedData) {\n          const parsed = JSON.parse(cachedData);\n          const age = Date.now() - parsed.timestamp;\n          const maxAge = 10 * 60 * 1000; // 10 minutos\n\n          if (age < maxAge) {\n            console.log(\n              `\u2705 Datos de curaci\xF3n obtenidos del cach\xE9 legacy para ${clientAuth.user} (${Math.round(age / 1000)}s antiguos)`\n            );\n            return {\n              curation24h: parsed.curation24h || 0,\n              curation7d: parsed.curation7d || 0,\n              curation30d: parsed.curation30d || 0,\n              lastUpdate: parsed.lastUpdate || new Date().toISOString(),\n              error: parsed.error || false,\n              source: 'legacy_cache',\n              user: clientAuth.user,\n              authenticated: true,\n            };\n          } else {\n            console.log('\u26A0\uFE0F Datos del cach\xE9 legacy expirados, limpiando...');\n            localStorage.removeItem(cacheKey);\n          }\n        }\n      }\n    } catch (err) {\n      console.warn('\u26A0\uFE0F Error accediendo al cach\xE9:', err);\n    }\n\n    // 2. Usar datos del servidor como fallback\n    const serverData = {\n      curation24h: curationStats ? (curationStats.curation24h ?? curationStats.total24Hr ?? 0) : 0,\n      curation7d: curationStats ? (curationStats.curation7d ?? curationStats.total7D ?? 0) : 0,\n      curation30d: curationStats ? (curationStats.curation30d ?? curationStats.total30D ?? 0) : 0,\n      lastUpdate: curationStats ? curationStats.lastUpdate : new Date().toISOString(),\n      error: error ? true : false,\n      source: 'server',\n      user: clientAuth.user,\n      authenticated: true,\n    };\n\n    // 3. Guardar en cach\xE9 si son datos v\xE1lidos del servidor\n    if (curationStats && !error) {\n      try {\n        const cacheData = {\n          ...serverData,\n          timestamp: Date.now(),\n        };\n\n        // Guardar en cach\xE9 por usuario si est\xE1 disponible\n        if (typeof window.userCache !== 'undefined') {\n          window.userCache.set('curation_stats', cacheData);\n        } else {\n          // Fallback al sistema legacy\n          const cacheKey = `curation_stats_${clientAuth.user}`;\n          localStorage.setItem(cacheKey, JSON.stringify(cacheData));\n        }\n\n        console.log('\u{1F4BE} Datos del servidor guardados en cach\xE9');\n      } catch (err) {\n        console.warn('\u26A0\uFE0F No se pudieron guardar datos en cach\xE9:', err);\n      }\n    }\n\n    console.log(`\u{1F4CA} Datos retornados desde: ${serverData.source}`);\n    return serverData;\n  };\n\n  // \u2705 FUNCI\xD3N PARA REFRESCAR ESTAD\xCDSTICAS DE CURACI\xD3N\n  window.refreshCurationStats = async function () {\n    console.log('\u{1F504} Forzando actualizaci\xF3n de estad\xEDsticas de curaci\xF3n...');\n\n    // \u2705 ANTI-DUPLICACI\xD3N: Verificar si ya hay una petici\xF3n en curso\n    if (isRefreshingCurationStats) {\n      console.log('\u26A0\uFE0F Ya hay una petici\xF3n de curation-stats en curso, reutilizando...');\n      return refreshCurationStatsPromise;\n    }\n\n    const clientAuth = checkClientAuthentication();\n    if (!clientAuth.isAuthenticated) {\n      console.warn('\u26A0\uFE0F Usuario no autenticado, no se puede refrescar');\n      return null;\n    }\n\n    // \u2705 ANTI-DUPLICACI\xD3N: Verificar cach\xE9 reciente (menos de 30 segundos)\n    let cacheData = null;\n    if (typeof window.userCache !== 'undefined') {\n      cacheData = window.userCache.get('curation_stats');\n    } else {\n      const cacheKey = `curation_stats_${clientAuth.user}`;\n      const stored = localStorage.getItem(cacheKey);\n      if (stored) {\n        try {\n          cacheData = JSON.parse(stored);\n        } catch (e) {\n          console.warn('\u26A0\uFE0F Error parsing cache data:', e);\n        }\n      }\n    }\n\n    // Si hay cach\xE9 muy reciente (menos de 30 segundos), lo usamos\n    if (cacheData && cacheData.timestamp && Date.now() - cacheData.timestamp < 30000) {\n      console.log('\u26A1 Usando cach\xE9 reciente (< 30s) para evitar duplicaci\xF3n');\n      return cacheData;\n    }\n\n    // \u2705 MARCAR COMO EN PROCESO\n    isRefreshingCurationStats = true;\n\n    try {\n      // Crear promesa para reutilizar si hay m\xFAltiples llamadas\n      refreshCurationStatsPromise = (async () => {\n        // Limpiar cach\xE9\n        if (typeof window.userCache !== 'undefined') {\n          window.userCache.remove('curation_stats');\n        } else {\n          const cacheKey = `curation_stats_${clientAuth.user}`;\n          localStorage.removeItem(cacheKey);\n        }\n\n        // Hacer petici\xF3n fresca\n        const response = await fetch('/api/curation-stats');\n        if (response.ok) {\n          const freshData = await response.json();\n\n          // Guardar en cach\xE9\n          const cacheData = {\n            ...freshData,\n            timestamp: Date.now(),\n            source: 'api',\n          };\n\n          if (typeof window.userCache !== 'undefined') {\n            window.userCache.set('curation_stats', cacheData);\n          } else {\n            const cacheKey = `curation_stats_${clientAuth.user}`;\n            localStorage.setItem(cacheKey, JSON.stringify(cacheData));\n          }\n\n          console.log('\u2705 Estad\xEDsticas actualizadas desde API');\n\n          // Disparar evento para actualizar UI\n          window.dispatchEvent(\n            new CustomEvent('curation-stats-updated', {\n              detail: freshData,\n            })\n          );\n\n          return freshData;\n        } else {\n          throw new Error(`HTTP ${response.status}`);\n        }\n      })();\n\n      const result = await refreshCurationStatsPromise;\n      return result;\n    } catch (err) {\n      console.error('\u274C Error actualizando estad\xEDsticas:', err);\n      return null;\n    } finally {\n      // \u2705 LIBERAR LOCK\n      isRefreshingCurationStats = false;\n      refreshCurationStatsPromise = null;\n    }\n  };\n\n  console.log('\u2705 Dashboard: Funciones de curaci\xF3n inicializadas');\n\n  // \u{1F680} FORZAR INICIALIZACI\xD3N INMEDIATA PARA EVITAR PROBLEMAS DE TIMING\n  if (typeof window !== 'undefined') {\n    // Verificar que la funci\xF3n est\xE9 disponible inmediatamente\n    setTimeout(() => {\n      if (typeof window.getCurationStatsData === 'function') {\n        console.log('\u2705 getCurationStatsData est\xE1 disponible y funcionando');\n      } else {\n        console.error('\u274C getCurationStatsData NO est\xE1 disponible - problema de inicializaci\xF3n');\n      }\n    }, 100);\n  }\n\n  // \u{1F504} CARGAR DATOS DE CURACI\xD3N CON RETRY AUTOM\xC1TICO\n  window.refreshCurationStats = async () => {\n    console.log('\u{1F504} Refrescando estad\xEDsticas de curaci\xF3n...');\n\n    // Verificar que la funci\xF3n est\xE9 disponible\n    if (typeof window.getCurationStatsData !== 'function') {\n      console.error('\u274C getCurationStatsData no est\xE1 disponible');\n      return;\n    }\n\n    try {\n      const data = await window.getCurationStatsData();\n      console.log('\u2705 Datos de curaci\xF3n obtenidos:', data);\n      return data;\n    } catch (error) {\n      console.error('\u274C Error al obtener datos de curaci\xF3n:', error);\n      throw error;\n    }\n  };\n\n  // \u{1F680} INICIALIZAR AUTOM\xC1TICAMENTE AL CARGAR LA P\xC1GINA\n  document.addEventListener('DOMContentLoaded', () => {\n    console.log('\u{1F4C4} DOM cargado, iniciando carga de curaci\xF3n...');\n\n    // Esperar un poco para que todas las funciones est\xE9n disponibles\n    setTimeout(() => {\n      if (typeof window.refreshCurationStats === 'function') {\n        window.refreshCurationStats().catch(error => {\n          console.error('\u274C Error en carga inicial de curaci\xF3n:', error);\n        });\n      }\n    }, 500);\n  });\n})();<\/script> ", ""], ["", " <script>(function(){", "\n  // \uFFFD FUNCI\xD3N GLOBAL DE AUTENTICACI\xD3N (\xFAnica definici\xF3n)\n  function checkClientAuthentication() {\n    if (typeof window === 'undefined') return { isAuthenticated: false, user: null };\n\n    const user = localStorage.getItem('authenticated_user');\n    return {\n      isAuthenticated: !!user,\n      user: user,\n    };\n  }\n\n  // \u{1F512} Control de duplicaci\xF3n para evitar m\xFAltiples peticiones simult\xE1neas\n  let isRefreshingCurationStats = false;\n  let refreshCurationStatsPromise = null;\n\n  // \u2705 FUNCI\xD3N GLOBAL PARA OBTENER DATOS DE CURACI\xD3N\n  window.getCurationStatsData = function () {\n    console.log('\u{1F4CA} getCurationStatsData llamada');\n\n    const clientAuth = checkClientAuthentication();\n    if (!clientAuth.isAuthenticated) {\n      console.warn('\u26A0\uFE0F Usuario no autenticado, no se pueden obtener estad\xEDsticas de curaci\xF3n');\n      return {\n        curation24h: 0,\n        curation7d: 0,\n        curation30d: 0,\n        lastUpdate: new Date().toISOString(),\n        error: 'Usuario no autenticado',\n        source: 'auth_error',\n        authenticated: false,\n      };\n    }\n\n    console.log(\\`\u{1F512} Usuario autenticado: \\${clientAuth.user}\\`);\n\n    // 1. Intentar obtener del cach\xE9 por usuario primero\n    try {\n      // Usar el nuevo sistema de cach\xE9 si est\xE1 disponible\n      if (typeof window.userCache !== 'undefined') {\n        const cachedData = window.userCache.get('curation_stats');\n        if (cachedData) {\n          const age = window.userCache.getAge('curation_stats') || 0;\n          console.log(\n            \\`\u2705 Datos de curaci\xF3n obtenidos del cach\xE9 por usuario para \\${clientAuth.user} (\\${Math.round(age / 1000)}s antiguos)\\`\n          );\n          return {\n            curation24h: cachedData.curation24h || 0,\n            curation7d: cachedData.curation7d || 0,\n            curation30d: cachedData.curation30d || 0,\n            lastUpdate: cachedData.lastUpdate || new Date().toISOString(),\n            error: cachedData.error || false,\n            source: 'user_cache',\n            user: clientAuth.user,\n            authenticated: true,\n          };\n        }\n      } else {\n        // Fallback al sistema legacy\n        const cacheKey = \\`curation_stats_\\${clientAuth.user}\\`;\n        const cachedData = localStorage.getItem(cacheKey);\n        if (cachedData) {\n          const parsed = JSON.parse(cachedData);\n          const age = Date.now() - parsed.timestamp;\n          const maxAge = 10 * 60 * 1000; // 10 minutos\n\n          if (age < maxAge) {\n            console.log(\n              \\`\u2705 Datos de curaci\xF3n obtenidos del cach\xE9 legacy para \\${clientAuth.user} (\\${Math.round(age / 1000)}s antiguos)\\`\n            );\n            return {\n              curation24h: parsed.curation24h || 0,\n              curation7d: parsed.curation7d || 0,\n              curation30d: parsed.curation30d || 0,\n              lastUpdate: parsed.lastUpdate || new Date().toISOString(),\n              error: parsed.error || false,\n              source: 'legacy_cache',\n              user: clientAuth.user,\n              authenticated: true,\n            };\n          } else {\n            console.log('\u26A0\uFE0F Datos del cach\xE9 legacy expirados, limpiando...');\n            localStorage.removeItem(cacheKey);\n          }\n        }\n      }\n    } catch (err) {\n      console.warn('\u26A0\uFE0F Error accediendo al cach\xE9:', err);\n    }\n\n    // 2. Usar datos del servidor como fallback\n    const serverData = {\n      curation24h: curationStats ? (curationStats.curation24h ?? curationStats.total24Hr ?? 0) : 0,\n      curation7d: curationStats ? (curationStats.curation7d ?? curationStats.total7D ?? 0) : 0,\n      curation30d: curationStats ? (curationStats.curation30d ?? curationStats.total30D ?? 0) : 0,\n      lastUpdate: curationStats ? curationStats.lastUpdate : new Date().toISOString(),\n      error: error ? true : false,\n      source: 'server',\n      user: clientAuth.user,\n      authenticated: true,\n    };\n\n    // 3. Guardar en cach\xE9 si son datos v\xE1lidos del servidor\n    if (curationStats && !error) {\n      try {\n        const cacheData = {\n          ...serverData,\n          timestamp: Date.now(),\n        };\n\n        // Guardar en cach\xE9 por usuario si est\xE1 disponible\n        if (typeof window.userCache !== 'undefined') {\n          window.userCache.set('curation_stats', cacheData);\n        } else {\n          // Fallback al sistema legacy\n          const cacheKey = \\`curation_stats_\\${clientAuth.user}\\`;\n          localStorage.setItem(cacheKey, JSON.stringify(cacheData));\n        }\n\n        console.log('\u{1F4BE} Datos del servidor guardados en cach\xE9');\n      } catch (err) {\n        console.warn('\u26A0\uFE0F No se pudieron guardar datos en cach\xE9:', err);\n      }\n    }\n\n    console.log(\\`\u{1F4CA} Datos retornados desde: \\${serverData.source}\\`);\n    return serverData;\n  };\n\n  // \u2705 FUNCI\xD3N PARA REFRESCAR ESTAD\xCDSTICAS DE CURACI\xD3N\n  window.refreshCurationStats = async function () {\n    console.log('\u{1F504} Forzando actualizaci\xF3n de estad\xEDsticas de curaci\xF3n...');\n\n    // \u2705 ANTI-DUPLICACI\xD3N: Verificar si ya hay una petici\xF3n en curso\n    if (isRefreshingCurationStats) {\n      console.log('\u26A0\uFE0F Ya hay una petici\xF3n de curation-stats en curso, reutilizando...');\n      return refreshCurationStatsPromise;\n    }\n\n    const clientAuth = checkClientAuthentication();\n    if (!clientAuth.isAuthenticated) {\n      console.warn('\u26A0\uFE0F Usuario no autenticado, no se puede refrescar');\n      return null;\n    }\n\n    // \u2705 ANTI-DUPLICACI\xD3N: Verificar cach\xE9 reciente (menos de 30 segundos)\n    let cacheData = null;\n    if (typeof window.userCache !== 'undefined') {\n      cacheData = window.userCache.get('curation_stats');\n    } else {\n      const cacheKey = \\`curation_stats_\\${clientAuth.user}\\`;\n      const stored = localStorage.getItem(cacheKey);\n      if (stored) {\n        try {\n          cacheData = JSON.parse(stored);\n        } catch (e) {\n          console.warn('\u26A0\uFE0F Error parsing cache data:', e);\n        }\n      }\n    }\n\n    // Si hay cach\xE9 muy reciente (menos de 30 segundos), lo usamos\n    if (cacheData && cacheData.timestamp && Date.now() - cacheData.timestamp < 30000) {\n      console.log('\u26A1 Usando cach\xE9 reciente (< 30s) para evitar duplicaci\xF3n');\n      return cacheData;\n    }\n\n    // \u2705 MARCAR COMO EN PROCESO\n    isRefreshingCurationStats = true;\n\n    try {\n      // Crear promesa para reutilizar si hay m\xFAltiples llamadas\n      refreshCurationStatsPromise = (async () => {\n        // Limpiar cach\xE9\n        if (typeof window.userCache !== 'undefined') {\n          window.userCache.remove('curation_stats');\n        } else {\n          const cacheKey = \\`curation_stats_\\${clientAuth.user}\\`;\n          localStorage.removeItem(cacheKey);\n        }\n\n        // Hacer petici\xF3n fresca\n        const response = await fetch('/api/curation-stats');\n        if (response.ok) {\n          const freshData = await response.json();\n\n          // Guardar en cach\xE9\n          const cacheData = {\n            ...freshData,\n            timestamp: Date.now(),\n            source: 'api',\n          };\n\n          if (typeof window.userCache !== 'undefined') {\n            window.userCache.set('curation_stats', cacheData);\n          } else {\n            const cacheKey = \\`curation_stats_\\${clientAuth.user}\\`;\n            localStorage.setItem(cacheKey, JSON.stringify(cacheData));\n          }\n\n          console.log('\u2705 Estad\xEDsticas actualizadas desde API');\n\n          // Disparar evento para actualizar UI\n          window.dispatchEvent(\n            new CustomEvent('curation-stats-updated', {\n              detail: freshData,\n            })\n          );\n\n          return freshData;\n        } else {\n          throw new Error(\\`HTTP \\${response.status}\\`);\n        }\n      })();\n\n      const result = await refreshCurationStatsPromise;\n      return result;\n    } catch (err) {\n      console.error('\u274C Error actualizando estad\xEDsticas:', err);\n      return null;\n    } finally {\n      // \u2705 LIBERAR LOCK\n      isRefreshingCurationStats = false;\n      refreshCurationStatsPromise = null;\n    }\n  };\n\n  console.log('\u2705 Dashboard: Funciones de curaci\xF3n inicializadas');\n\n  // \u{1F680} FORZAR INICIALIZACI\xD3N INMEDIATA PARA EVITAR PROBLEMAS DE TIMING\n  if (typeof window !== 'undefined') {\n    // Verificar que la funci\xF3n est\xE9 disponible inmediatamente\n    setTimeout(() => {\n      if (typeof window.getCurationStatsData === 'function') {\n        console.log('\u2705 getCurationStatsData est\xE1 disponible y funcionando');\n      } else {\n        console.error('\u274C getCurationStatsData NO est\xE1 disponible - problema de inicializaci\xF3n');\n      }\n    }, 100);\n  }\n\n  // \u{1F504} CARGAR DATOS DE CURACI\xD3N CON RETRY AUTOM\xC1TICO\n  window.refreshCurationStats = async () => {\n    console.log('\u{1F504} Refrescando estad\xEDsticas de curaci\xF3n...');\n\n    // Verificar que la funci\xF3n est\xE9 disponible\n    if (typeof window.getCurationStatsData !== 'function') {\n      console.error('\u274C getCurationStatsData no est\xE1 disponible');\n      return;\n    }\n\n    try {\n      const data = await window.getCurationStatsData();\n      console.log('\u2705 Datos de curaci\xF3n obtenidos:', data);\n      return data;\n    } catch (error) {\n      console.error('\u274C Error al obtener datos de curaci\xF3n:', error);\n      throw error;\n    }\n  };\n\n  // \u{1F680} INICIALIZAR AUTOM\xC1TICAMENTE AL CARGAR LA P\xC1GINA\n  document.addEventListener('DOMContentLoaded', () => {\n    console.log('\u{1F4C4} DOM cargado, iniciando carga de curaci\xF3n...');\n\n    // Esperar un poco para que todas las funciones est\xE9n disponibles\n    setTimeout(() => {\n      if (typeof window.refreshCurationStats === 'function') {\n        window.refreshCurationStats().catch(error => {\n          console.error('\u274C Error en carga inicial de curaci\xF3n:', error);\n        });\n      }\n    }, 500);\n  });\n})();<\/script> ", ""])), renderComponent($$result, "Layout", $$Layout, {}, { "default": async ($$result2) => renderTemplate`  ${renderComponent($$result2, "BrandContainer", $$BrandContainer, { "variant": "page", "class": "min-h-screen py-8" }, { "default": async ($$result3) => renderTemplate` ${maybeRenderHead()}<div class="space-y-8"> <!-- Header wrapped in brand card --> ${authenticatedUser && renderTemplate`${renderComponent($$result3, "Header", $$Header, { "username": authenticatedUser })}`} <!-- Filters wrapped in brand card with enhanced styling --> ${renderComponent($$result3, "Filters", $$Filters, {})} <!-- Delegations Table in brand card --> ${renderComponent($$result3, "BrandCard", $$BrandCard, { "class": "overflow-hidden animate-slide-up" }, { "default": async ($$result4) => renderTemplate` ${renderComponent($$result4, "TableDelegations", $$TableDelegations, {})} ` })} <!-- Cache Status Indicator --> ${renderComponent($$result3, "CacheStatusIndicator", $$CacheStatusIndicator, {})} </div> ` })} ` }), defineScriptVars({ curationStats, error, authenticatedUser, isAuthenticated }), renderScript($$result, "/Users/eddiespino/aliento-pay-eddiespino/src/pages/dashboard.astro?astro&type=script&index=0&lang.ts"));
}, "/Users/eddiespino/aliento-pay-eddiespino/src/pages/dashboard.astro", void 0);

const $$file = "/Users/eddiespino/aliento-pay-eddiespino/src/pages/dashboard.astro";
const $$url = "/dashboard";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Dashboard,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
